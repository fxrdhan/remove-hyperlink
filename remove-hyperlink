#!/bin/bash

# Function to display script usage
usage() {
    echo "Usage: $0 input.md [output.md]"
    exit 1
}

# Check if there is at least one argument
if [ $# -lt 1 ]; then
    usage
fi

input_file="$1"

# Check if the input file exists
if [ ! -f "$input_file" ]; then
    echo "Error: File '$input_file' not found."
    exit 1
fi

# If there is a second argument, use it as the output file
if [ $# -ge 2 ]; then
    output_file="$2"
    # Use sed to remove hyperlinks and save to the output file
    sed -E '
        # Remove hyperlinks with pattern [[text\]](url)
        s/\[\[([^\\\]]+)\\?\]\]\([^)]*\)/\1/g;
        # Remove standard hyperlinks [text](url)
        s/\[([^]]+)\]\([^)]*\)/\1/g
    ' "$input_file" > "$output_file"
    echo "Hyperlinks have been removed and the result is saved in '$output_file'."
else
    # If there is no second argument, display the result in the terminal
    sed -E '
        s/\[\[([^\\\]]+)\\?\]\]\([^)]*\)/\1/g;
        s/\[([^]]+)\]\([^)]*\)/\1/g
    ' "$input_file"
fi
